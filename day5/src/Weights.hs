{-# LANGUAGE TypeFamilies #-}
module Weights
    ( w0
    , w1
    , im
    ) where

import           Data.Massiv.Array hiding ( map, zip, unzip )
import qualified Data.Massiv.Array as A

-- > extract' (0 :> 0) (Sz (1 :> 1 :> 5 :. 5)) w0
-- Array M Seq (Sz (1 :> 1 :> 5 :. 5))
--   [ [ [ [ -5.34187e-2, -0.42678, -0.3788081, -0.1806156, -0.2589863 ]
--       , [ 0.2156626, 2.298e-3, 0.1362538, 9.06657e-2, 8.78454e-2 ]
--       , [ 0.3264671, 0.3181283, 0.3527859, 0.1273208, 0.1496966 ]
--       , [ 0.1065092, 0.226041, 0.1678512, 0.2619891, 0.1658615 ]
--       , [ -0.2026702, -0.3002051, -0.2787303, -0.3063709, -0.1232836 ]
--       ]
--     ]
--   ]
w0 :: Array U Ix4 Float
w0 = A.resize' (Sz (3 :> 1 :> 5 :. 5)) w
  where
    w = A.fromLists' Seq _w0 :: Array U Ix3 Float

w1 :: Array U Ix4 Float
w1 = A.fromLists' Seq _w1

_w0 :: [[[Float]]]
_w0 = [
      [
        [0.3709277, 0.1315887, -0.0217935, -0.0874873, -0.1814238],
        [0.2094532, 0.3839384, 0.4958460, 0.3471998, 0.1214935],
        [-0.0041823, 0.2383546, 0.3916787, 0.2468123, 0.1866332],
        [-0.2148883, -0.1393941, -0.0780958, 0.1978448, 0.3078061],
        [-0.2906907, -0.3621872, -0.2229310, -0.1614075, 0.1021839]
      ],
      [
        [0.1727189, 0.2721161, 0.4206782, -0.1500809, -0.0926090],
        [0.2509846, 0.4338722, 0.2978484, -0.3338364, -0.4037588],
        [0.0747024, 0.4383090, 0.0814298, -0.0665992, -0.2439181],
        [0.1974681, 0.0867741, 0.2755355, -0.0702023, -0.0973341],
        [0.0681689, 0.1175186, 0.2609006, -0.0066601, -0.0647432]
      ],
      [
        [-0.1601912, -0.0931311, -0.0591369, -0.0205861, 0.3600077],
        [0.0754773, 0.0193453, 0.1303142, 0.5167721, 0.3418249],
        [0.0091026, 0.4068400, 0.4794764, 0.3816426, -0.1891327],
        [0.1428635, 0.0907255, -0.0329744, -0.2622978, -0.3450789],
        [0.1677206, -0.0949282, -0.1549080, -0.2371758, -0.1611647]
      ]
      ]

_w1 :: [[[[Float]]]]
_w1 = [
         [
            [
                [-0.0749277, -0.1933468, -0.2504357, -0.1861190, -0.0519292],
                [-0.1140869, -0.3170756, -0.3812616, -0.1906293, -0.0504072],
                [-0.1396729, -0.2738970, -0.0280716, 0.0003550, 0.0154594],
                [-0.0819335, -0.1099269, 0.1252692, 0.1697428, -0.0497010],
                [-0.1211204, 0.1390258, 0.2479094, 0.0952416, -0.0275210]
            ],
            [
                [-0.0040089, -0.0086927, 0.2324754, 0.1910037, 0.1222480],
                [-0.0705723, 0.0013588, 0.0822237, 0.1675478, 0.0728472],
                [-0.0568506, 0.2714543, 0.1762671, 0.0073511, 0.0588483],
                [0.0264378, 0.1545327, 0.0291663, -0.0131496, -0.1441715],
                [0.1179399, 0.1462093, 0.0226150, -0.1663618, -0.0806301]
            ],
            [
                [0.1223185, 0.1088521, 0.2060680, 0.1587235, -0.0234320],
                [0.1825719, 0.3819371, 0.4250199, 0.3697666, 0.0638464],
                [0.1641503, 0.2484079, 0.2760600, 0.1635845, -0.0913489],
                [-0.2008138, -0.1152392, -0.0120366, 0.1219040, -0.0841538],
                [-0.3670289, -0.1802292, -0.1256149, 0.0020413, -0.1561126]
            ]
        ],
        [
            [
                [-0.1795876, 0.0694997, 0.0304304, 0.0976985, -0.0422012],
                [-0.1322545, -0.0527051, 0.1003565, 0.1895364, -0.2137976],
                [0.0997421, 0.0127946, 0.0406687, 0.2014800, -0.0471085],
                [0.3043359, 0.2914063, 0.0912854, 0.1117691, 0.0560423],
                [0.1209635, 0.3021815, 0.3230126, 0.2151247, 0.0100441]
            ],
            [
                [0.0441132, 0.2664226, 0.2140008, 0.0225114, 0.1469477],
                [-0.1563017, -0.1623464, -0.2803195, -0.2904668, -0.3237906],
                [-0.0181373, -0.2444247, -0.5734650, -0.5659213, -0.4329163],
                [-0.0359438, -0.1396621, -0.2083339, -0.0501966, 0.0692364],
                [0.0006679, 0.0553824, 0.1383297, 0.1780105, -0.1130183]
            ],
            [
                [0.0257236, -0.0999415, 0.2182164, 0.3317524, 0.3127412],
                [0.0390745, 0.0800678, 0.0773254, 0.0344959, -0.2944679],
                [0.0303132, -0.1027987, -0.1682145, 0.1015030, -0.1044774],
                [0.2280138, 0.3597429, 0.2071063, 0.2145798, 0.1220568],
                [0.0641320, 0.1943730, 0.0072743, 0.0288691, 0.0434496]
            ]
        ],
        [
            [
                [-0.0717222, -0.0201421, 0.0818810, 0.1010445, 0.0246889],
                [0.0218155, 0.1773871, 0.2248479, -0.0693797, -0.1606622],
                [0.2433888, 0.2972065, 0.2422952, 0.0878458, -0.1790683],
                [-0.0062360, 0.1273059, 0.0731132, -0.1176045, -0.2137308],
                [-0.0740193, -0.1638075, -0.1424453, -0.2232441, -0.0752980]
            ],
            [
                [0.2470107, 0.3195547, 0.0631292, 0.0454944, 0.0214540],
                [0.0875947, 0.3325523, 0.0762059, -0.0085545, -0.0763706],
                [0.0174606, 0.0910481, -0.0112622, 0.1646343, -0.0228829],
                [-0.1900174, -0.1136922, -0.0358995, 0.1259755, -0.0582323],
                [-0.1262116, -0.0436460, 0.0504809, 0.1138650, -0.0122541]
            ],
            [
                [-0.1454835, -0.0381751, -0.0525930, -0.0899055, -0.0035967],
                [-0.2012197, -0.0182407, 0.1056227, 0.1320936, 0.0284524],
                [-0.0989225, -0.0644091, 0.2213759, 0.0592801, 0.0826649],
                [-0.0003194, -0.0172013, 0.0219131, 0.0156565, -0.0998196],
                [0.1044031, -0.0117453, -0.0838047, -0.0652941, -0.1890139]
            ]
        ]
    ]

-- TODO: do not forget image normalization with ((0.1307,), (0.3081,))
-- The first image in MNIST
im :: Array U Ix2 Float
im = A.fromLists' Seq _im
  where
    _im = [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0.0117647,0.0705882,0.0705882,0.0705882,0.494118,0.533333,0.686275,0.101961,0.65098,1,0.968627,0.498039,0,0,0,0],
        [0,0,0,0,0,0,0,0,0.117647,0.141176,0.368627,0.603922,0.666667,0.992157,0.992157,0.992157,0.992157,0.992157,0.882353,0.67451,0.992157,0.94902,0.764706,0.25098,0,0,0,0],
        [0,0,0,0,0,0,0,0.192157,0.933333,0.992157,0.992157,0.992157,0.992157,0.992157,0.992157,0.992157,0.992157,0.984314,0.364706,0.321569,0.321569,0.219608,0.152941,0,0,0,0,0],
        [0,0,0,0,0,0,0,0.0705882,0.858824,0.992157,0.992157,0.992157,0.992157,0.992157,0.776471,0.713725,0.968627,0.945098,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0.313725,0.611765,0.419608,0.992157,0.992157,0.803922,0.0431373,0,0.168627,0.603922,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0.054902,0.00392157,0.603922,0.992157,0.352941,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0.545098,0.992157,0.745098,0.00784314,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0.0431373,0.745098,0.992157,0.27451,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0.137255,0.945098,0.882353,0.627451,0.423529,0.00392157,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0.317647,0.941176,0.992157,0.992157,0.466667,0.0980392,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.176471,0.729412,0.992157,0.992157,0.588235,0.105882,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0627451,0.364706,0.988235,0.992157,0.733333,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.976471,0.992157,0.976471,0.25098,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.180392,0.509804,0.717647,0.992157,0.992157,0.811765,0.00784314,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0.152941,0.580392,0.898039,0.992157,0.992157,0.992157,0.980392,0.713725,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0.0941176,0.447059,0.866667,0.992157,0.992157,0.992157,0.992157,0.788235,0.305882,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0.0901961,0.258824,0.835294,0.992157,0.992157,0.992157,0.992157,0.776471,0.317647,0.00784314,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0.0705882,0.670588,0.858824,0.992157,0.992157,0.992157,0.992157,0.764706,0.313725,0.0352941,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0.215686,0.67451,0.886275,0.992157,0.992157,0.992157,0.992157,0.956863,0.521569,0.0431373,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0.533333,0.992157,0.992157,0.992157,0.831373,0.529412,0.517647,0.0627451,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
      ]
